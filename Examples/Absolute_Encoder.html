<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Absolute Encoder &mdash; Labjack Unified 0.0.5 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /><link rel="shortcut icon" href="../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Electric Motor" href="Electric_Motor.html" />
    <link rel="prev" title="Incremental Encoder" href="Incremental_Encoder.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Labjack Unified<img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../LabJackU3.html">LabJackU3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LabJackU6.html">LabJackU6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LabJackT7.html">LabJackT7</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Analog_IO.html">Analog I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="Digital_IO.html">Digital I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="Streaming.html">Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="Incremental_Encoder.html">Incremental Encoder</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Absolute Encoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="Electric_Motor.html">Electric Motor</a></li>
<li class="toctree-l2"><a class="reference internal" href="Electric_Motor_with_Encoder.html">Electric Motor with Encoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="T7_Streaming_Internal.html">T7 Streaming (internal clock)</a></li>
<li class="toctree-l2"><a class="reference internal" href="T7_Streaming_External.html">T7 Streaming (external clock)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Utils.html">Utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Labjack Unified</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Examples</a> &raquo;</li>
      <li>Absolute Encoder</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Examples/Absolute_Encoder.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="absolute-encoder">
<h1>Absolute Encoder<a class="headerlink" href="#absolute-encoder" title="Permalink to this headline">ÔÉÅ</a></h1>
<p>In this example code, the reference mark (Z phase pulse) is determined by slowly turning
the encoder shaft. Then, the absolute angular position is displayed, during 30 seconds as
the shaft is turned.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; lj_encoder_absolute.py</span>

<span class="sd">Displays quadrature encoder angular speed.</span>

<span class="sd">This example code shows how to setup a quadrature encoder and how to calculate</span>
<span class="sd">and display the angular position of the shaft. A rotary encoder with A-B and Z</span>
<span class="sd">phases is required for this short coding example. A CALT GHS38 rotary encoder</span>
<span class="sd">was used.</span>

<span class="sd">Setup:</span>
<span class="sd">    On a U3, connect FIO4 to phase A, FIO5 to phase B, and FIO6 to phase Z</span>
<span class="sd">    On a U6, connect FIO0 to phase A, FIO1 to phase B, and FIO2 to phase Z</span>
<span class="sd">    On a T7, connect FIO2 to phase A, FIO3 to phase B, and FIO1 to phase Z</span>
<span class="sd">    Connect the encoder Vcc and GND to the LabJack VS and GND respectively</span>

<span class="sd">The LabJack unified methods in this example are:</span>
<span class="sd">    set_quadrature ... Sets LabJack configuration for encoder A-B-Z input</span>
<span class="sd">    get_counter ...... Gets edge count from encoder A-B signals</span>
<span class="sd">    close ............ Closes the LabJack device</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">labjack_unified.devices</span> <span class="kn">import</span> <span class="n">LabJackU3</span><span class="p">,</span> <span class="n">LabJackU6</span><span class="p">,</span> <span class="n">LabJackT7</span>

<span class="c1"># To use a different LabJack, change the device name</span>
<span class="c1"># from LabJackU3 below to either LabJackU6 or LabJackT7</span>
<span class="n">lj</span> <span class="o">=</span> <span class="n">LabJackU3</span><span class="p">()</span>

<span class="c1"># Selecting phase Z port name based on the LabJack class</span>
<span class="k">if</span> <span class="n">lj</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">LabJackU3</span><span class="p">:</span>
    <span class="n">portZ</span> <span class="o">=</span> <span class="s1">&#39;FIO6&#39;</span>
<span class="k">elif</span> <span class="n">lj</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">LabJackU6</span><span class="p">:</span>
    <span class="n">portZ</span> <span class="o">=</span> <span class="s1">&#39;FIO2&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">portZ</span> <span class="o">=</span> <span class="s1">&#39;FIO1&#39;</span>

<span class="c1"># Setting quadrature encoder with Z phase</span>
<span class="n">lj</span><span class="o">.</span><span class="n">set_quadrature</span><span class="p">(</span><span class="n">zphase1</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Defining encoder pulses per revolution</span>
<span class="c1"># (Because rising and falling edges on phases A and B</span>
<span class="c1">#  are counted, multiply the encoder PPR by 4)</span>
<span class="n">ppr</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="mi">1000</span>

<span class="c1"># Execution loop to get Z phase and reset count</span>
<span class="n">flagref</span> <span class="o">=</span> <span class="kc">False</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Turn encoder until reference is found.&#39;</span><span class="p">)</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">flagref</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">lj</span><span class="o">.</span><span class="n">get_digital</span><span class="p">(</span><span class="n">portZ</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">flagref</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found it!&#39;</span><span class="p">)</span>

<span class="c1"># Initializing variables and starting main clock</span>
<span class="n">angleprev</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">tcurr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">tstart</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="c1"># 30-second execution loop that displays the</span>
<span class="c1"># current angular position of the encoder shaft</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running code for 30 seconds ...&#39;</span><span class="p">)</span>
<span class="k">while</span> <span class="n">tcurr</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">:</span>
    <span class="c1"># Pausing for a bit</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="c1"># Getting current time (s)</span>
    <span class="n">tcurr</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">tstart</span>
    <span class="c1"># Getting angular position of the encoder</span>
    <span class="n">anglecurr</span> <span class="o">=</span> <span class="mi">360</span><span class="o">/</span><span class="n">ppr</span> <span class="o">*</span> <span class="n">lj</span><span class="o">.</span><span class="n">get_counter</span><span class="p">()</span>
    <span class="c1"># Printing angle when it changes</span>
    <span class="k">if</span> <span class="n">anglecurr</span> <span class="o">!=</span> <span class="n">angleprev</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Position = </span><span class="si">{:0.1f}</span><span class="s1"> deg.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">anglecurr</span><span class="p">))</span>
        <span class="n">angleprev</span> <span class="o">=</span> <span class="n">anglecurr</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done.&#39;</span><span class="p">)</span>

<span class="c1"># Closing the device</span>
<span class="n">lj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">del</span> <span class="n">lj</span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Incremental_Encoder.html" class="btn btn-neutral float-left" title="Incremental Encoder" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Electric_Motor.html" class="btn btn-neutral float-right" title="Electric Motor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Eduardo Nigro.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>